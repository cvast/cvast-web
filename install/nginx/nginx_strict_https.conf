
# http
server {
    server_name <domain_names>;
    listen 80;
    
	# Allow access to the letsencrypt ACME Challenge
	location ~ /\.well-known\/acme-challenge {
	  allow all;
	  root /var/www;
	}
	
	location /robots.txt {
		return 200 "User-agent: *\nDisallow:<allow_or_disallow>\n";
	}

    return 301 https://$host$request_uri;
    
}


# https
server {
    listen       443 ssl http2;
    server_name  <domain_names>;
	
	ssl_certificate /etc/letsencrypt/live/localhost/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/localhost/privkey.pem;
	
	# Uncomment this line only after testing in browsers,
    # as it commits you to continuing to serve your site over HTTPS
    # in future
    # add_header Strict-Transport-Security "max-age=31536000";
	
	access_log /var/log/nginx/sub.log combined;

	# maintain the .well-known directory alias for renewals
	location ~ /\.well-known\/acme-challenge {
	  allow all;
	  root /var/www;
	}
	
    location / {
        root      /usr/share/nginx/html;
        index     index.html index.htm;
        try_files $uri/index.html $uri.html $uri @upstream;
    }
	
	location /media {
		alias /www/static/;
	}

	location /robots.txt {
		return 200 "User-agent: *\nDisallow:<allow_or_disallow>\n";
	}
	
    location @upstream {
		proxy_set_header X-Forwarded-Proto https;
        proxy_set_header Host $host;
        proxy_pass http://<proxy_container>:8000;
    }
}